<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Guide to preparing data for a gene expression meta-analysis • metapredict</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Guide to preparing data for a gene expression meta-analysis">
<meta property="og:description" content="metapredict">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">metapredict</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/guide.html">Guide to preparing data for a gene expression meta-analysis</a>
    </li>
    <li>
      <a href="../articles/prepare_example.html">Preparing to run a gene expression meta-analysis of lung cancer subtypes</a>
    </li>
    <li>
      <a href="../articles/run_example.html">Running a gene expression meta-analysis of lung cancer subtypes</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/hugheylab/metapredict/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="guide_files/header-attrs-2.11/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Guide to preparing data for a gene expression meta-analysis</h1>
            
            <h4 class="date">2021-10-15</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/hugheylab/metapredict/blob/master/vignettes/guide.Rmd"><code>vignettes/guide.Rmd</code></a></small>
      <div class="hidden name"><code>guide.Rmd</code></div>

    </div>

    
    
<p>This vignette describes how to prepare data and metadata for a gene expression meta-analysis according to the method of <a href="https://doi.org/10.1093/nar/gkv229">Hughey and Butte (2015)</a>.</p>
<div id="find-relevant-datasets" class="section level2">
<h2 class="hasAnchor">
<a href="#find-relevant-datasets" class="anchor"></a>Find relevant datasets</h2>
<p>The first step is to find microarray datasets relevant to what you’re interested in. Most datasets will be on NCBI GEO or ArrayExpress, but not all, so it’s a good idea to also search the literature.</p>
</div>
<div id="create-the-table-of-study-metadata" class="section level2">
<h2 class="hasAnchor">
<a href="#create-the-table-of-study-metadata" class="anchor"></a>Create the table of study metadata</h2>
<p>The study metadata should be a comma-delimited text file, with one row for each study and at least the following columns:</p>
<table class="table">
<colgroup>
<col width="17%">
<col width="82%">
</colgroup>
<thead><tr class="header">
<th align="left">Name</th>
<th align="left">Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><code>study</code></td>
<td align="left">Name of the study, which must be unique.</td>
</tr>
<tr class="even">
<td align="left"><code>studyDataType</code></td>
<td align="left">Indicates how the expression data is stored (see below for details).</td>
</tr>
<tr class="odd">
<td align="left"><code>platformInfo</code></td>
<td align="left">Microarray platform, used for mapping probes to genes (see below for details).</td>
</tr>
</tbody>
</table>
<p>There are currently five options for <code>studyDataType</code>:</p>
<table class="table">
<colgroup>
<col width="20%">
<col width="79%">
</colgroup>
<thead><tr class="header">
<th align="left"><code>studyDataType</code></th>
<th align="left">Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><code>affy_geo</code></td>
<td align="left">Raw Affymetrix data from a GEO study.</td>
</tr>
<tr class="even">
<td align="left"><code>affy_custom</code></td>
<td align="left">Raw Affymetrix data from a non-GEO study (e.g., ArrayExpress).</td>
</tr>
<tr class="odd">
<td align="left"><code>affy_series_matrix</code></td>
<td align="left">Normalized, untransformed, probe-level Affymetrix data in a GEO series matrix file.</td>
</tr>
<tr class="even">
<td align="left"><code>series_matrix</code></td>
<td align="left">Normalized, log-transformed (or equivalent) data in a GEO series matrix file.</td>
</tr>
<tr class="odd">
<td align="left"><code>eset_rds</code></td>
<td align="left">Normalized, log-transformed (or equivalent) data, already mapped to Entrez Gene IDs, saved as an <code>ExpressionSet</code> in an RDS file.</td>
</tr>
</tbody>
</table>
<p>The options for <code>platformInfo</code> depend on the <code>studyDataType</code>:</p>
<table class="table">
<colgroup>
<col width="53%">
<col width="46%">
</colgroup>
<thead><tr class="header">
<th align="left"><code>studyDataType</code></th>
<th align="left"><code>platformInfo</code></th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">
<code>affy_geo</code>, <code>affy_custom</code>, or <code>affy_series_matrix</code>
</td>
<td align="left">Name of corresponding BrainArray custom cdf</td>
</tr>
<tr class="even">
<td align="left"><code>series_matrix</code></td>
<td align="left">Corresponding GPL identifier</td>
</tr>
<tr class="odd">
<td align="left"><code>eset_rds</code></td>
<td align="left"><code>ready</code></td>
</tr>
</tbody>
</table>
</div>
<div id="download-the-gene-expression-data" class="section level2">
<h2 class="hasAnchor">
<a href="#download-the-gene-expression-data" class="anchor"></a>Download the gene expression data</h2>
<p>The format of the gene expression data for each study should correspond to its <code>studyDataType</code>. All the folders and/or files with expression data should be in one parent folder.</p>
<table class="table">
<colgroup>
<col width="40%">
<col width="59%">
</colgroup>
<thead><tr class="header">
<th align="left"><code>studyDataType</code></th>
<th align="left">Format of expression data if name of study is <code>GSE98765</code>
</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">
<code>affy_geo</code> or <code>affy_custom</code>
</td>
<td align="left">Folder named <code>GSE98765</code> containing cel or cel.gz files.</td>
</tr>
<tr class="even">
<td align="left">
<code>affy_series_matrix</code> or <code>series_matrix</code>
</td>
<td align="left">File from GEO named <code>GSE98765_series_matrix.txt.gz</code>.</td>
</tr>
<tr class="odd">
<td align="left"><code>eset_rds</code></td>
<td align="left">RDS file named <code>GSE98765.rds</code> containing a Bioconductor <code>ExpressionSet</code>.</td>
</tr>
</tbody>
</table>
</div>
<div id="if-necessary-download-packages-and-files-for-mapping-affy-probe-sets-to-entrez-gene-ids" class="section level2">
<h2 class="hasAnchor">
<a href="#if-necessary-download-packages-and-files-for-mapping-affy-probe-sets-to-entrez-gene-ids" class="anchor"></a>If necessary, download packages and files for mapping Affy probe sets to Entrez Gene IDs</h2>
<ol style="list-style-type: decimal">
<li>
<p>For studies whose <code>studyDataType</code> is <code>affy_geo</code> or <code>affy_custom</code>, install the custom CDF package(s). See the <code>installCustomCdfPackages</code> documentation for details.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">?</span><span class="fu">metapredict</span><span class="fu">::</span><span class="va"><a href="../reference/installCustomCdfPackages.html">installCustomCdfPackages</a></span></code></pre></div>
</li>
<li>
<p>For studies whose <code>studyDataType</code> is <code>affy_series_matrix</code>, download the custom CDF mapping(s). See the <code>downloadCustomCdfMappings</code> documentation for details.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">?</span><span class="fu">metapredict</span><span class="fu">::</span><span class="va"><a href="../reference/downloadCustomCdfMappings.html">downloadCustomCdfMappings</a></span></code></pre></div>
</li>
</ol>
</div>
<div id="check-that-all-studies-whose-studydatatype-series_matrix-are-supported" class="section level2">
<h2 class="hasAnchor">
<a href="#check-that-all-studies-whose-studydatatype-series_matrix-are-supported" class="anchor"></a>Check that all studies whose <code>studyDataType == 'series_matrix'</code> are supported</h2>
<ol style="list-style-type: decimal">
<li>
<p>Open R and execute the following commands, replacing “&lt;path to study metadata file&gt;” as appropriate.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">studyMetadata</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">'&lt;path to study metadata file&gt;'</span>, stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="fu">metapredict</span><span class="fu">::</span><span class="fu"><a href="../reference/getUnsupportedPlatforms.html">getUnsupportedPlatforms</a></span><span class="op">(</span><span class="va">studyMetadata</span><span class="op">)</span></code></pre></div>
</li>
<li>
<p>If any platforms are not supported but you still want to include those studies in the meta-analysis, you will need to edit the source of the metapredict package.</p>
<ol style="list-style-type: decimal">
<li>In the <code><a href="../reference/getStudyData.html">getStudyData()</a></code> function, add another <code>else if</code> statement that tells the function how to map probes to Entrez Gene IDs for that platform. Look at the code for currently supported platforms to see examples of how this is done.</li>
<li>Add the GPL for the microarray platform to the character vector of supported platforms in the <code><a href="../reference/getSupportedPlatforms.html">getSupportedPlatforms()</a></code> function.</li>
<li>Submit a pull request to <a href="https://github.com/hugheylab/metapredict" class="uri">https://github.com/hugheylab/metapredict</a>, so other people can analyze data from that platform without going through the same hassle!</li>
</ol>
</li>
</ol>
</div>
<div id="create-the-table-of-sample-metadata" class="section level2">
<h2 class="hasAnchor">
<a href="#create-the-table-of-sample-metadata" class="anchor"></a>Create the table of sample metadata</h2>
<p>The sample metadata should be a comma-delimited text file, with one row for each sample and at least the following columns:</p>
<table class="table">
<colgroup>
<col width="40%">
<col width="59%">
</colgroup>
<thead><tr class="header">
<th align="left">Name</th>
<th align="left">Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><code>study</code></td>
<td align="left">Name of the corresponding study.</td>
</tr>
<tr class="even">
<td align="left"><code>sample</code></td>
<td align="left">Name of the sample, which must be unique across all studies.</td>
</tr>
<tr class="odd">
<td align="left">
<code>outcome</code>, <code>class</code>, or something similar</td>
<td align="left">Variable that the meta-analysis will be trying to predict.</td>
</tr>
</tbody>
</table>
<p>The format of the sample names depends on the <code>studyDataType</code>:</p>
<table class="table">
<colgroup>
<col width="37%">
<col width="62%">
</colgroup>
<thead><tr class="header">
<th align="left"><code>studyDataType</code></th>
<th align="left">Format of sample names</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">
<code>affy_geo</code> or <code>affy_custom</code>
</td>
<td align="left">Names of the .cel or .cel.gz files (excluding the file extension).</td>
</tr>
<tr class="even">
<td align="left">
<code>affy_series_matrix</code> or <code>series_matrix</code>
</td>
<td align="left">Names of the GSM identifiers from the series matrix file.</td>
</tr>
<tr class="odd">
<td align="left"><code>eset_rds</code></td>
<td align="left">colnames of the expression matrix in the <code>ExpressionSet</code>.</td>
</tr>
</tbody>
</table>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Jake Hughey, Josh Schoenbachler.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
